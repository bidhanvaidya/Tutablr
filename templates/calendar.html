
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="generator" content="HTML Tidy for Windows (vers 14 February 2006), see www.w3.org" />
	<link rel='stylesheet' type='text/css' href='{{STATIC_URL}}fullcalendar/jquery-ui-1.9.0.custom.css' />
    <link rel='stylesheet' type='text/css' href='{{STATIC_URL}}fullcalendar/fullcalendar.css' />
    <link rel='stylesheet' type='text/css' href='{{STATIC_URL}}fullcalendar/fullcalendar.print.css' media='print' />
	<script type="text/javascript" src="{{STATIC_URL}}fullcalendar/jquery-1.8.2.js"></script>
    <script type='text/javascript' src='{{STATIC_URL}}fullcalendar/jquery-ui-1.9.0.custom.js'></script>
    <script type='text/javascript' src='{{STATIC_URL}}fullcalendar/fullcalendar.min.js'></script>
	
    <script type='text/javascript'>
//<![CDATA[

$(document).ready(function() {
	$('#calendar').fullCalendar({
	    eventDrop: function(event,dayDelta,minuteDelta,allDay,revertFunc) {			
			if(!event.editable){
				revertFunc();
			}else{
				var start_time = $.fullCalendar.formatDate(event.start, "HH:mm");
				var end_time = $.fullCalendar.formatDate(event.end, "HH:mm");
				var start_date = $.fullCalendar.formatDate(event.start, "dd/MM/yyyy");
				var end_date = $.fullCalendar.formatDate(event.end, "dd/MM/yyyy");
				var id = event.id;
				var title = event.title;
				var type = event.type;
				$("#edit_start").val(start_time);
				$("#edit_end").val(end_time);
				$("#edit_title").val(title);
				$("#edit_event_id").val(id);
				$("#type").val(type);
				$('#datePicker_start_edit').attr("disabled", false);
				$('#datePicker_end_edit').attr("disabled", false);
				$('#datePicker_start_edit').val(start_date);
				$('#datePicker_end_edit').val(end_date);
				//$("#edit_event" ).dialog( "open" );
				if(event.type != "unavailable"){
					$("#edit_event" ).dialog( "open" );
				}else{
					$("[id*=SubmitEdit]").click();
				}
			}
		},
				
		header: {
				left: 'prev,next today',
				center: 'title',
				right: 'month,agendaWeek,agendaDay'
		},
		defaultView: 'agendaWeek',
		selectable: true,
		selectHelper: true,
		editable: true,
		disableResizing: true,
		aspectRatio: 1.75,
		select: function(start, end, allDay) {
			var date = new Date();
		  if(start < date )
              {
                // Do whatever you want here.
                alert('Cannot select past dates.');
                return;
                
              };
			var start_time = $.fullCalendar.formatDate(start, "HH:mm");
			alert(start);
			var end_time = $.fullCalendar.formatDate(end, "HH:mm");
			var start_date = $.fullCalendar.formatDate(start, "dd/MM/yyyy");
			var end_date = $.fullCalendar.formatDate(end, "dd/MM/yyyy");
			$("#add_start").val(start_time);
			$("#add_end").val(end_time);
			$("#add_event" ).dialog( "open" );
			$('#datePicker_start_add').attr("disabled", false);
			$('#datePicker_end_add').attr("disabled", false);
			$('#datePicker_start_add').val(start_date);
			$('#datePicker_end_add').val(end_date);
			calendar.fullCalendar('unselect');
		},
		eventClick: function(event, jsEvent, view){
			if(event.editable){
				var start_time = $.fullCalendar.formatDate(event.start, "HH:mm");
				var end_time = $.fullCalendar.formatDate(event.end, "HH:mm");
				var start_date = $.fullCalendar.formatDate(event.start, "dd/MM/yyyy");
				var end_date = $.fullCalendar.formatDate(event.end, "dd/MM/yyyy");
				var id = event.id;
				var title = event.title;
				var type = event.type;
				$("#edit_start").val(start_time);
				$("#edit_end").val(end_time);
				$("#edit_title").val(title);
				$("#edit_event_id").val(id);
				$("#type").val(type);
				$('#datePicker_start_edit').attr("disabled", false);
				$('#datePicker_end_edit').attr("disabled", false);
				$('#datePicker_start_edit').val(start_date);
				$('#datePicker_end_edit').val(end_date);
				$("#edit_event" ).dialog( "open" );
			}
		},
		events: 'events.json'
	});
	// jQuery UI Dialog
	$('#edit_event').dialog({
		autoOpen: false,
		width: 400,
		height: 300,
		modal: true,
		resizable: true,
		open: function() {
			$('#datePicker_start_edit').removeAttr("disabled");
			$('#datePicker_end_edit').removeAttr("disabled");
		},
		close: function () {
			$('#datePicker_start_edit').datepicker('hide');
			$('#datePicker_end_edit').datepicker('hide');
		},
		buttons: {
                        "Submit": function() {
                                $(this).dialog("close");
                                $(location).attr('href',$(this).dialog('option', 'anchor'));
				$("[id*=SubmitEdit]").click();
                                return true;
                        },
                        "Cancel": function() {
                                $(this).dialog("close");
                               
                                return false;
                        },
				"Delete": function() {
                                $(this).dialog("close");
				$(location).attr('href',$(this).dialog('option', 'anchor'));
				$("[id*=SubmitDelete]").click();
                                return true;
                        }
                }
		
	});
	$('#add_event').dialog({
		autoOpen: false,
		width: 400,
		height: 300,
		modal: true,
		resizable: true,
		open: function() {
			$('#datePicker_start_add').removeAttr("disabled");
			$('#datePicker_end_add').removeAttr("disabled");
		},
		close: function () {
			$('#datePicker_start_add').datepicker('hide');
			$('#datePicker_end_add').datepicker('hide');
		},
		buttons: {
                        "Submit": function() {
                                $(this).dialog("close");
                                $(location).attr('href',$(this).dialog('option', 'anchor'));
								$("[id*=SubmitAdd]").click();
                                return true;
                        },
                        "Cancel": function() {
                                $(this).dialog("close");
                                
                                
                                return false;
                        }
                }
		
	});

	$("#datePicker_end_edit").datepicker({ dateFormat: 'dd:mm:yy', minDate: 0  });
	$("#datePicker_start_edit").datepicker({ dateFormat: 'dd:mm:yy', minDate: 0  });
	$("#datePicker_end_add").datepicker({ dateFormat: 'dd:mm:yy', minDate: 0  });
	$("#datePicker_start_add").datepicker({ dateFormat: 'dd:mm:yy', minDate: 0  });

	
	
});
function showText(num)
	{
		if(num==0)
			document.getElementById('edit_div').style.display='block';
		else
			document.getElementById('edit_div').style.display='none';
		return;
	}
    //]]>
    </script>
    <style type='text/css'>
/*<![CDATA[*/

    body {
        margin-top: 40px;
        text-align: center;
        font-size: 14px;
        font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
    }

    #calendar {
    width: 800px;
    margin: 0 auto;
    }

    /*]]>*/
    </style>
    <title></title>
  </head>
  <body>
  {{ uos }}
    <div id="edit_event" title="Edit Event">
      <form action="/../../update" name="editForm" method="post">{% csrf_token %}
        <fieldset>
		    <div id="edit_div">
                 <label for = "edit_date_start"> End Date </label> 
        		    <input type="text" name = "edit_start_date" id="datePicker_start_edit" required="required" readonly="readonly" /> <br>
			    <label for = "edit_date_end"> End Date </label> 
			        <input type="text" name = "edit_end_date" id="datePicker_end_edit" readonly="readonly" required="required" /> <br>
              	
              	<label for="edit_start">Start</label> 

              	    <input type="text" name="edit_start" id="edit_start" class="text ui-widget-content ui-corner-all" required="required" /> <br>
		      	<label for="edit_end">End Time</label> 
		      	    <input type="text" name="edit_end" id="edit_end" class="text ui-widget-content ui-corner-all" required="required" /><br>
              	<label for="title">Event Description</label> 
              	    <input type="text" name="edit_title" id="edit_title" class="text ui-widget-content ui-corner-all" required="required" /> 
		    </div>
		    <input type="hidden" name="edit_event_id" id="edit_event_id" class="text ui-widget-content ui-corner-all" required="required" />
		    <input type="text" name="type" id="type" class="text ui-widget-content ui-corner-all" required="required" />
        </fieldset>
         <input type="submit" value="Yes" id ="SubmitEdit" style="display:none"> 
         <input  type= "submit" formaction= "/../delete" id ="SubmitDelete" style="display:none">
      </form>
    </div>
    <div id="add_event" title="Add Event">
    <form action="/../../add_unavailable" name="addForm" method="post">{% csrf_token %}
        <fieldset>

            <label for = "add_date_start"> Start Date </label>
                <input type="text" name = "add_start_date" id="datePicker_start_add" required="required" readonly="readonly" /> <br>
            <label for = "add_date_end"> End Date </label> 
                <input type="text" name = "add_end_date" id="datePicker_end_add" required="required" readonly="readonly" /> <br>

            <label for="edit_start">Start</label> 
                <input type="text" name="add_start" id="add_start" class="text ui-widget-content ui-corner-all" required="required" /> <br>
            <label for="add_end">End</label> 
                <input type="timeField" name="add_end" id="add_end" class="text ui-widget-content ui-corner-all" required="required" /><br>
            <label for="add_title">Event Description</label> 
                <input type="text" name="add_title" id="add_title" class="text ui-widget-content ui-corner-all" required="required" /> <br>
        </fieldset>
    <input type="submit" value="Yes" id="SubmitAdd" style="display:none"> 
    
    </form>
    </div>
    <div id='calendar'></div>
  </body>
</html>
